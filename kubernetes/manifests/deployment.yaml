# Source: krawl-chart/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: krawl
  namespace: krawl-system
  labels:
    app.kubernetes.io/name: krawl
    app.kubernetes.io/instance: krawl
    app.kubernetes.io/version: "1.0.0"
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: krawl
      app.kubernetes.io/instance: krawl
  template:
    metadata:
      labels:
        app.kubernetes.io/name: krawl
        app.kubernetes.io/instance: krawl
    spec:
      containers:
      - name: krawl-chart
        image: "ghcr.io/blessedrebus/krawl:1.0.0"
        imagePullPolicy: Always
        ports:
        - name: http
          containerPort: 5000
          protocol: TCP
        env:
        - name: CONFIG_LOCATION
          value: "config.yaml"
        volumeMounts:
        - name: config
          mountPath: /app/config.yaml
          subPath: config.yaml
          readOnly: true
        - name: wordlists
          mountPath: /app/wordlists.json
          subPath: wordlists.json
          readOnly: true
        - name: database
          mountPath: /app/data
        resources:
            limits:
              cpu: 500m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 64Mi
      volumes:
      - name: config
        configMap:
          name: krawl-config
      - name: wordlists
        configMap:
          name: krawl-wordlists
      - name: database
        persistentVolumeClaim:
          claimName: krawl-db
